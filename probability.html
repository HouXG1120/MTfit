

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>6. Probability &mdash; mtfit documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="_static/style.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="mtfit documentation" href="index.html"/>
        <link rel="next" title="7. mtfit.algorithms: Search Algorithms" href="algorithms.html"/>
        <link rel="prev" title="5. Bayesian Approach" href="bayes.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> mtfit
          

          
            
            <img src="_static/mtfitsphinx.png" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                1.0.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="setup.html">1. Installing</a></li>
<li class="toctree-l1"><a class="reference internal" href="run.html">2. Running mtfit</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">3. Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="real-tutorial.html">4. Tutorial: Real Data Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="bayes.html">5. Bayesian Approach</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">6. Probability Density Functions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#polarity-pdf">6.1. Polarity <code class="docutils literal"><span class="pre">PDF</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#polarity-probability-pdf">6.3. Polarity Probability <code class="docutils literal"><span class="pre">PDF</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#amplitude-ratio-pdf">6.5. Amplitude Ratio <code class="docutils literal"><span class="pre">PDF</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="algorithms.html">7. Search Algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="mtconvert.html">8. Moment Tensor Conversion</a></li>
<li class="toctree-l1"><a class="reference internal" href="cli.html">9. Command Line Options</a></li>
<li class="toctree-l1"><a class="reference internal" href="mtplot.html">10. Plotting</a></li>
<li class="toctree-l1"><a class="reference internal" href="plot_classes.html">11. Plot Classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="mtplotcli.html">12. MTplot Command Line Options</a></li>
<li class="toctree-l1"><a class="reference internal" href="inversion.html">13. Inversion Class</a></li>
<li class="toctree-l1"><a class="reference internal" href="extensions.html">14. Extensions</a></li>
<li class="toctree-l1"><a class="reference internal" href="references.html">15. References</a></li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">16. Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="source.html">17. Source Code</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/djpugh/MTfit">GitHub Repository</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">mtfit</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>6. Probability</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/probability.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="probability">
<h1>6. Probability<a class="headerlink" href="#probability" title="Permalink to this headline">¶</a></h1>
<p><code class="xref py py-mod docutils literal"><span class="pre">mtfit</span></code> has <a class="reference internal" href="glossary.html#term-pdf"><span class="xref std std-term">PDF</span></a> s for two data types, with two different approaches to measuring the polarity.</p>
<p>However, it is possible to add <a class="reference internal" href="glossary.html#term-pdf"><span class="xref std std-term">PDF</span></a> s for other data-types (see <a class="reference internal" href="extensions.html"><span class="doc">Extending mtfit</span></a>)</p>
<div class="section" id="polarity-pdf">
<span id="polarity-pdf-label"></span><h2>6.1. Polarity <a class="reference internal" href="glossary.html#term-pdf"><span class="xref std std-term">PDF</span></a><a class="headerlink" href="#polarity-pdf" title="Permalink to this headline">¶</a></h2>
</div>
<p><a class="reference internal" href="references.html#pugh-2016a"><span class="std std-ref">Pugh et al, 2016a</span></a> has a derivation of the polarity <a class="reference internal" href="glossary.html#term-pdf"><span class="xref std std-term">PDF</span></a> used in <code class="xref py py-mod docutils literal"><span class="pre">mtfit</span></code>. It is given by:</p>
<div class="math">
\[\mathrm{p}\left(Y=y\,|\, A,\sigma_{y},\varpi\right)=\frac{1}{2}\left(1+\mathrm{erf}\left(\frac{yA}{\sqrt{2}\sigma_{y}}\right)\right)\left(1-\varpi\right)+\frac{1}{2}\left(1+\mathrm{erf}\left(\frac{-yA}{\sqrt{2}\sigma_{y}}\right)\right)\varpi\]</div>
<p>The different symbols in this equation are:</p>
<table border="1" class="docutils">
<colgroup>
<col width="46%" />
<col width="54%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><em>Symbol</em></th>
<th class="head"><em>Meaning</em></th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><span class="math">\(Y\)</span></td>
<td>Polarity</td>
</tr>
<tr class="row-odd"><td><span class="math">\(A\)</span></td>
<td>Amplitude</td>
</tr>
<tr class="row-even"><td><span class="math">\(\sigma_{y}\)</span></td>
<td>Uncertainty</td>
</tr>
<tr class="row-odd"><td><span class="math">\(\varpi\)</span></td>
<td>Mispick Probability</td>
</tr>
</tbody>
</table>
<p>and <span class="math">\(\mathrm{erf}\left(x\right)\)</span> is the error function, given by <span class="math">\(\mathrm{erf}\left(x\right)=\frac{2}{\sqrt{\pi}}\int_{0}^{x}\mathrm{e}^{-t^{2}}\mathrm{d}t\)</span>.</p>
<p>This approach requires an estimate of the uncertainty <span class="math">\(\sigma_{y}\)</span>. This is not the noise at the arrival, since it does not scale correctly in comparison to the modelled amplitude due to the propagation effects. It could be estimated from the fractional amplitude uncertainty, but this will be greater than or equal to the true value, because the amplitude at a receiver is only ever less than or equal to the maximum theoretical amplitude (accounting for propagation effects). Consequently, this would most likely overestimate the uncertainty. It is clear that the uncertainty value should be station-specific as noise environments at different stations often vary, so the maximum estimate of the event signal-to-noise ratio (SNR) fails to account for the variation across the receivers.</p>
<p>The difficulty in estimating <span class="math">\(\sigma_{y}\)</span> is increased further when polarity picking is done manually, so the uncertainty on the trace is perhaps not even known. Due to the difficulty in quantifying the uncertainty, it is best left as a user-defined parameter that reflects the confidence in the arrival polarity pick, which can be mapped to the pick quality. However, <a class="reference internal" href="references.html#pugh-2016b"><span class="std std-ref">Pugh et al, 2016b</span></a> proposes an alternate method for calculating polarity uncertainties that can be included in this framework (see <a class="reference internal" href="#polarity-prob-pdf"><span class="std std-ref">Polarity Probability PDF</span></a>)</p>
<div class="section" id="polarity-probability-pdf">
<span id="polarity-prob-pdf"></span><h2>6.3. Polarity Probability <a class="reference internal" href="glossary.html#term-pdf"><span class="xref std std-term">PDF</span></a><a class="headerlink" href="#polarity-probability-pdf" title="Permalink to this headline">¶</a></h2>
</div>
<p><a class="reference internal" href="references.html#pugh-2016b"><span class="std std-ref">Pugh et al, 2016b</span></a> introduces an alternate method for estimating the polarity, using an automated Bayesian probability estimate. This approach results in estimates of the postive and negative polarity probabilities.
<code class="xref py py-mod docutils literal"><span class="pre">autopol</span></code> provides a Python module for calculating these values (<a class="reference internal" href="references.html#pugh-2016a"><span class="std std-ref">Pugh, 2016a</span></a>), and may be available on request. These observations can be included in  <code class="xref py py-mod docutils literal"><span class="pre">mtfit</span></code>, although the data independence must be preserved. The <a class="reference internal" href="glossary.html#term-pdf"><span class="xref std std-term">PDF</span></a> is:</p>
<div class="math">
\[\mathrm{p}\left(\psi|A,\sigma,\tau,\sigma_{\tau},\varpi\right)=1-\varpi+\left(2\varpi-1\right)\left[\mathrm{H}\left(A\right)+\psi-2\mathrm{H}\left(A\right)\varpi\right]\]</div>
<p>The different symbols in this equation are:</p>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><em>Symbol</em></th>
<th class="head"><em>Meaning</em></th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><span class="math">\(\psi\)</span></td>
<td>Polarity Probability</td>
</tr>
<tr class="row-odd"><td><span class="math">\(A\)</span></td>
<td>Amplitude</td>
</tr>
<tr class="row-even"><td><span class="math">\(\sigma\)</span></td>
<td>Trace Noise</td>
</tr>
<tr class="row-odd"><td><span class="math">\(\tau\)</span></td>
<td>Pick Time</td>
</tr>
<tr class="row-even"><td><span class="math">\(\sigma_{\tau}\)</span></td>
<td>Pick Time Noise</td>
</tr>
<tr class="row-odd"><td><span class="math">\(\varpi\)</span></td>
<td>Mispick Probability</td>
</tr>
</tbody>
</table>
<p>and <span class="math">\(\mathrm{H}\left(x\right)\)</span> is the Heaviside step function, given by <span class="math">\(\mathrm{H}\left(x\right)=\int_{-\infty}^{x}\delta\left(s\right)\mathrm{d}s\)</span>.</p>
<div class="section" id="amplitude-ratio-pdf">
<span id="ratio-pdf-label"></span><h2>6.5. Amplitude Ratio <a class="reference internal" href="glossary.html#term-pdf"><span class="xref std std-term">PDF</span></a><a class="headerlink" href="#amplitude-ratio-pdf" title="Permalink to this headline">¶</a></h2>
</div>
<p>The amplitude ratio <a class="reference internal" href="glossary.html#term-pdf"><span class="xref std std-term">PDF</span></a> used in <code class="xref py py-mod docutils literal"><span class="pre">mtfit</span></code> is based on the ratio <a class="reference internal" href="glossary.html#term-pdf"><span class="xref std std-term">PDF</span></a> for two gaussian distributed variables (<a class="reference internal" href="references.html#hinkley-1969"><span class="std std-ref">Hinkley, 1969</span></a>):</p>
<div class="math">
\[\begin{split}P\left(r\right)=\frac{b\left(r\right)d\left(r\right)}{\sigma_{x}\sigma_{y}a^{3}\left(r\right)\sqrt{2\pi}}\left[\Phi\left(\frac{b\left(r\right)}{a\left(r\right)\sqrt{1-\rho^{2}}}\right)-\Phi\left(\frac{-b\left(r\right)}{a\left(r\right)\sqrt{1-\rho^{2}}}\right)\right]\\
+\frac{\sqrt{1-\rho^{2}}}{\pi\sigma_{x}\sigma_{y}a^{2}\left(r\right)}e^{\left(-\frac{c}{2\left(1-\rho^{2}\right)}\right)}\end{split}\]</div>
<p>With coefficients <span class="math">\(a\left(r\right)\)</span>, <span class="math">\(b\left(r\right)\)</span>, <span class="math">\(c\)</span>  and <span class="math">\(d\left(r\right)\)</span> given by :</p>
<div class="math">
\[\begin{split}a\left(r\right) =   \sqrt{\frac{r^{2}}{\sigma_{x}^{2}}-2\rho\frac{r}{\sigma_{x}\sigma_{y}}+\frac{1}{\sigma_{y}^{2}}}\\
b\left(r\right) =   \frac{\mu_{x}r}{\sigma_{x}^{2}}-\rho\frac{\mu_{x}+\mu_{y}r}{\sigma_{x}\sigma_{y}}+\frac{\mu_{y}}{\sigma_{y}^{2}}\\
c   =   \frac{\mu_{x}^{2}}{\sigma_{x}^{2}}-2\rho\frac{\mu_{x}\mu_{y}}{\sigma_{x}\sigma_{y}}+\frac{\mu_{y}^{2}}{\sigma_{y}^{2}}\\
d\left(r\right) =   e^{\left(\frac{b^{2}\left(r\right)-ca^{2}\left(r\right)}{2\left(1-\rho^{2}\right)a^{2}\left(r\right)}\right)}\\\end{split}\]</div>
<p>The resultant <a class="reference internal" href="glossary.html#term-pdf"><span class="xref std std-term">PDF</span></a> is (unsigned amplitude ratios):</p>
<div class="math">
\[P\left(R=r\,|\, A_{x},A_{y},\sigma_{x},\sigma_{y}\right)=\mathcal{R_{N}}\left(r,A_{x},A_{y},\sigma_{x},\sigma_{y}\right)+\mathcal{R_{N}}\left(-r,A_{x},A_{y},\sigma_{x},\sigma_{y}\right)\]</div>
<p>With <span class="math">\(\mathcal{R_{N}}\left(r,\mu_{x},\mu_{y},\sigma_{x},\sigma_{y}\right)\)</span> referring to the ratio <a class="reference internal" href="glossary.html#term-pdf"><span class="xref std std-term">PDF</span></a> above, since <span class="math">\(\rho\)</span>, the correlation between the variables, is zero.</p>
<p>The different symbols in this equation are:</p>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><em>Symbol</em></th>
<th class="head"><em>Meaning</em></th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><span class="math">\(R\)</span></td>
<td>Amplitude Ratio</td>
</tr>
<tr class="row-odd"><td><span class="math">\(A\)</span></td>
<td>Amplitude</td>
</tr>
<tr class="row-even"><td><span class="math">\(\sigma\)</span></td>
<td>Amplitude Noise</td>
</tr>
</tbody>
</table>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="algorithms.html" class="btn btn-neutral float-right" title="7. mtfit.algorithms: Search Algorithms" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="bayes.html" class="btn btn-neutral" title="5. Bayesian Approach" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, David Pugh.
      Last updated on Nov 19, 2017 (version 1.0.0).

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.0.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>